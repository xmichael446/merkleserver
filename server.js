const {MerkleTree} = require("merkletreejs");
const keccak256 = require("keccak256");
const express = require("express");
const cors = require("cors");

const app = express();

app.use(cors());

const whitelist = ["0x95995f8FC312BFCB7Ec924a73fE6381d477B45ad", "0xF752fA6F956CEC4831abf80958D70f264470375c", "0x6023F877B09e2657bc705A66b2421CaeD66f9052", "0x95983F2CEA59E857E509BD890007EDBD03DC80EF", "0x786824DE170D9D4A98728C1D5634543CDDD50AB6", "0x4EF033C823AB6E0BF2DDBC8B982568955DC11381", "0x6D64C1E023B5A303D871CE0CABE34CB5EB68C822", "0x1660D013CDE152A73FAC3699E8745F5412A4E6B9", "0x32C53CF06525EA6455D234A1D6C4014DCA1E7BF7", "0x47b2Ee634a2681B12E7325A3068B8Fb65fd567d4", "0xDC8A254EF0A85CE16B02E55044FDBCF70F37AA52", "0x03AC8A524B465737CC3B017A95DD2D997649C683", "0xC429D7AAD46B6CB570D15E6865C02CEF9AF3B9BD", "0x043E648A3641C343235FCB4780FB0EC95053578C", "0xD9953DA809561E2B89C697E495CE0163C65422C1", "0xA0A741135902D9F7411D27E1DDE4B71B6A1B81B5", "0xA9E7F4C62B61A54F6614FC4E2A6071BD3107398F", "0x62E8A611E9AF477BA764B81FA5D6A89694ED773E", "0xC1498F57E6C0B199AD02C0922924F96864D676B1", "0xB7515A3B07DF4E54BECBC6DE8E5EA17170395BF1", "0xBC49B62D101003701EA72450A649A4BFF822BA44", "0xE31EE32E2E533FD3B48C908B4D3349D24ED88193", "0x2E391BB99FA8EEB194EC87828E57BA6DA5D7EEF3", "0xB6DE34524A79E76AD2304292CE3BB5BFAC4B0CD8", "0x452A0694441DD7AD4D19D4D01170BFB9C9753D84"].map(x => keccak256(x));

const tree = new MerkleTree(whitelist, keccak256, {sortPairs: true});
console.log(tree.getHexRoot())
app.get("/proof", (req, res) => {
    const proof = tree.getHexProof(keccak256(req.query.address));
    res.send(JSON.stringify(proof));
});

const server = app.listen(8000, () => {
    console.log("Server started on port 8000");
});