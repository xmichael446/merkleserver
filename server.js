const {MerkleTree} = require("merkletreejs");
const keccak256 = require("keccak256");
const express = require("express");
const cors = require("cors");

const app = express();

app.use(cors());

const whitelist = ["0xf7d2fD9037c2c08995B8ee7BB469642379AB027A", "0x0D33d9eCd28b7f579D5297EA74976Df540D0291b", "0x1d8283034fFE50b2CEf46268cc737FA2390f59D2", "0x42935Ad676249745A25e6B09dC096827278cdF60", "0x8c54926BbFfa95885F963F27bff909eDe563dd90", "0x7B25113B3e96bADbf82B2baD229E9D5158799eC3", "0xCe92d0465C705F303FAebc77Be4e6D039D1aAB9B", "0xdE597e159c07A7bA03FEc47f45D51Ff277074E11", "0xA419E6E4bb43f292c545e7a9b72b3104a5dfAFD4", "0x85ae29eF6D38f0595A91e6F4E114202abD21725C", "0xCC0baa524A4702b7aAda374e151Ccc77C3CB2d11", "0x978aCf2a394955aD45E5001d23924CDe75D24963", "0x4450fb37a4DA0b57458742Cc288459A1969E845c", "0x071cBCB657c9412bb02584E1DE4005154A4D8854", "0xa232aBd055F5C76730109d5f7B09597bd2242506", "0x58A570BEB067e095ec5283F5B1A57e63515a483a", "0xbc9dd3bb74453fB6E5e8668ce7fE78bF361D4617", "0xddD11efc1D75970628D2d52bCef40af00011D2F0", "0xEbf49892Bd44cbf4f0d2f5fb589F360AcfB7c7Ff", "0xFb054de87c048fE9f9D859afE6059d023529E0d8", "0x366e6db6c96A9eFc1a4fE07CaC87125305bB4cD9", "0x0615774010B017E7Ec09D228ef37d06564A1d825", "0x04895fAd9879885218F6324234cD400b14A2DEcd", "0xF877923CF9F105F98a107E8f94521fa50A355c0d", "0xc6656eb326fF7Ca3F24Bfc067f1550D98B108029", "0xA39e74F803C703b2cF33E6127605dbd043108eA0", "0xaA5389CCe9e86593b38896373E1F454025534BF5", "0x1DbBEc72Fc72406851aB9d42c18dc52aBEbBB287", "0x337Eb67619571E47855d09D64E7AcaBB9a05b70D", "0x0ee9df423D1d34b1df34B3e223cC9E6F122Bf260","0xdEed4c8b5ae34B1a06D49AB1c0807d0d4C7b55EE", "0x0cE6593Ab499c601dA02fc7881bA0db5950B14D0"].map(x => keccak256(x));

const tree = new MerkleTree(whitelist, keccak256, {sortPairs: true});
console.log(tree.getHexRoot())
app.get("/proof", (req, res) => {
    const proof = tree.getHexProof(keccak256(req.query.address));
    res.send(JSON.stringify(proof));
});

const server = app.listen(process.env.PORT || 8000, () => {
    console.log(`Server started on port ${process.env.PORT || 8000}`);
});